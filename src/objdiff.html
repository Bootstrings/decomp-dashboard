<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Melee Decomp - Verification Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .progress-bar-bg { background-color: #e5e7eb; }
        .progress-bar { background-color: #2563eb; transition: width 0.5s ease-in-out; }
        .status-matched { color: #16a34a; }
        .status-mismatch { color: #dc2626; }
        tr.mismatch-row:hover { background-color: #fef2f2; }
        tr.expandable:hover { cursor: pointer; }
        .details-row { background-color: #f9fafb; }
        .details-row td { padding: 0 !important; }
        .details-content { padding: 1rem; }
        /* New styles for sortable headers */
        .sortable { cursor: pointer; user-select: none; }
        .sortable:hover { color: #1e293b; }
        .sort-asc::after { content: ' ▲'; font-size: 0.7em; }
        .sort-desc::after { content: ' ▼'; font-size: 0.7em; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">
    <div class="container mx-auto p-4 md:p-8">
        <header class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-4xl font-bold text-slate-900">Verification Dashboard</h1>
                <p class="text-slate-600 mt-1">Project-wide diff report using `objdiff-cli`.</p>
            </div>
            <button id="back-to-main-btn" class="bg-slate-600 text-white px-4 py-2 rounded-md hover:bg-slate-700">← Back to Main</button>
        </header>

        <main>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-semibold">Project Status</h2>
                    <button id="run-report-btn" class="bg-indigo-600 text-white font-bold px-6 py-3 rounded-md hover:bg-indigo-700">Run Verification Report</button>
                </div>

                <!-- Status Summary -->
                <div id="summary-section" class="mb-6 hidden">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="p-4 bg-slate-50 rounded-lg">
                            <p class="text-sm text-slate-500">Overall Progress</p>
                            <p id="overall-progress" class="text-2xl font-bold">0%</p>
                        </div>
                        <div class="p-4 bg-slate-50 rounded-lg">
                            <p class="text-sm text-slate-500">Matched Objects</p>
                            <p id="matched-objects" class="text-2xl font-bold">0 / 0</p>
                        </div>
                         <div class="p-4 bg-slate-50 rounded-lg">
                            <p class="text-sm text-slate-500">Report Timestamp</p>
                            <p id="report-timestamp" class="text-2xl font-bold">N/A</p>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="progress-bar-bg w-full rounded-full h-4">
                            <div id="progress-bar" class="progress-bar h-4 rounded-full" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>

                <!-- NEW: Filter Controls -->
                <div id="controls-section" class="mb-4 hidden">
                    <input type="text" id="filter-input" placeholder="Filter by name..." class="w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <!-- Results Table -->
                <div id="results-container" class="overflow-x-auto">
                    <p id="report-placeholder" class="text-center text-slate-500 py-8">Click "Run Verification Report" to start.</p>
                    <table id="results-table" class="min-w-full divide-y divide-slate-200 hidden">
                        <thead class="bg-slate-50">
                            <tr>
                                <!-- UPDATED: Added sortable classes and data attributes -->
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider sortable" data-sort-key="name">Object Name</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider sortable" data-sort-key="match_percent">Match %</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Status</th>
                            </tr>
                        </thead>
                        <tbody id="table-body" class="bg-white divide-y divide-slate-200">
                            <!-- Rows will be inserted here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="./objdiff.js"></script>
</body>
</html>